Teradata Jaqy Console 1.0
-- 0: 0/0 -----------------------------------------------------------------
--------------------------------------------------------------------------
-- test SQL types
--------------------------------------------------------------------------
.format csv
-- 0: 0/1 -----------------------------------------------------------------
.run setup.sql
-- Running script: setup.sql
-- 0: 0/2 -----------------------------------------------------------------
.classpath teradata lib\tdgssconfig.jar;lib\terajdbc4.jar
-- 0: 0/3 -----------------------------------------------------------------
.open -u dbc -p dbc teradata://192.168.32.129
-- 0: 0/4 -----------------------------------------------------------------
.run ../common/ansi_types.sql
-- Running script: ../common/ansi_types.sql
-- 0: 0/5 -----------------------------------------------------------------
--------------------------------------------------------------------------
-- SQL92 types
--------------------------------------------------------------------------

-- Bit (SQL 99 removed it)

-- bit string literal
SELECT B'1100' AS Test;

-- failure 3707: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3707] [SQLState 42000] Syntax error, expected something like a name or a Unicode delimited identifier between the word 'B' and the string '1100'.
-- 0: 1/5 -----------------------------------------------------------------
SELECT CAST(B'1100' AS BIT(16)) AS Test;

-- failure 3706: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3706] [SQLState 42000] Syntax error: expected something between the word 'B' and the string '1100'.
-- 0: 2/5 -----------------------------------------------------------------
SELECT CAST(B'1100' AS BIT VARYING(16)) AS Test;

-- failure 3706: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3706] [SQLState 42000] Syntax error: expected something between the word 'B' and the string '1100'.
-- 0: 3/5 -----------------------------------------------------------------

-- Numerical types
SELECT CAST(12 AS SMALLINT) AS Test;

-- success. results are:
Test
12
-- activity count = 1
-- 0: 4/5 -----------------------------------------------------------------
SELECT CAST(123456789 AS INTEGER) AS Test;

-- success. results are:
Test
123456789
-- activity count = 1
-- 0: 5/5 -----------------------------------------------------------------
SELECT CAST(123456789 AS NUMERIC) AS Test;

-- failure 2616: [22003] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 2616] [SQLState 22003] Numeric overflow occurred during computation.
-- 0: 6/5 -----------------------------------------------------------------
SELECT CAST(-1234567.89 AS DEC(10,2)) AS Test;

-- success. results are:
Test
-1234567.89
-- activity count = 1
-- 0: 7/5 -----------------------------------------------------------------
SELECT CAST(-1234567.89 AS DECIMAL(10,2)) AS Test;

-- success. results are:
Test
-1234567.89
-- activity count = 1
-- 0: 8/5 -----------------------------------------------------------------
SELECT CAST(-1234567.89 AS DECIMAL) AS Test;

-- failure 2616: [22003] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 2616] [SQLState 22003] Numeric overflow occurred during computation.
-- 0: 9/5 -----------------------------------------------------------------

SELECT CAST(-1234567.89 AS FLOAT) AS Test;

-- success. results are:
Test
-1234567.89
-- activity count = 1
-- 0: 10/5 ----------------------------------------------------------------
SELECT CAST(-1234567.89 AS FLOAT(2)) AS Test;

-- success. results are:
Test
-1234567.89
-- activity count = 1
-- 0: 11/5 ----------------------------------------------------------------
SELECT CAST(-1234567.89 AS REAL) AS Test;

-- success. results are:
Test
-1234567.89
-- activity count = 1
-- 0: 12/5 ----------------------------------------------------------------
SELECT CAST(-1234567.89 AS DOUBLE PRECISION) AS Test;

-- success. results are:
Test
-1234567.89
-- activity count = 1
-- 0: 13/5 ----------------------------------------------------------------

-- Characters

-- character string literal
SELECT 'A quick brown fox' AS Test;

-- success. results are:
Test
A quick brown fox
-- activity count = 1
-- 0: 14/5 ----------------------------------------------------------------
-- natioinal character string literal
SELECT N'A quick brown fox' AS Test;

-- failure 3707: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3707] [SQLState 42000] Syntax error, expected something like a name or a Unicode delimited identifier between the word 'N' and the string 'A quick brown fox'.
-- 0: 15/5 ----------------------------------------------------------------
-- hex string literal
SELECT X'DEADBEEF' AS Test;

-- success. results are:
Test
����
-- activity count = 1
-- 0: 16/5 ----------------------------------------------------------------

SELECT CAST('A quick brown fox' AS CHARACTER(20)) AS Test;

-- success. results are:
Test
A quick brown fox   
-- activity count = 1
-- 0: 17/5 ----------------------------------------------------------------
SELECT CAST('A quick brown fox' AS CHAR(20)) AS Test;

-- success. results are:
Test
A quick brown fox   
-- activity count = 1
-- 0: 18/5 ----------------------------------------------------------------

SELECT CAST('A quick brown fox' AS CHARACTER VARYING(20)) AS Test;

-- success. results are:
Test
A quick brown fox
-- activity count = 1
-- 0: 19/5 ----------------------------------------------------------------
SELECT CAST('A quick brown fox' AS CHAR VARYING(20)) AS Test;

-- success. results are:
Test
A quick brown fox
-- activity count = 1
-- 0: 20/5 ----------------------------------------------------------------
SELECT CAST('A quick brown fox' AS VARCHAR(20)) AS Test;

-- success. results are:
Test
A quick brown fox
-- activity count = 1
-- 0: 21/5 ----------------------------------------------------------------

SELECT CAST('A quick brown fox' AS NATIONAL CHARACTER(20)) AS Test;

-- failure 3706: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3706] [SQLState 42000] Syntax error: Data Type "NATIONAL" does not match a Defined Type name.
-- 0: 22/5 ----------------------------------------------------------------
SELECT CAST('A quick brown fox' AS NATIONAL CHAR(20)) AS Test;

-- failure 3706: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3706] [SQLState 42000] Syntax error: Data Type "NATIONAL" does not match a Defined Type name.
-- 0: 23/5 ----------------------------------------------------------------
SELECT CAST('A quick brown fox' AS NCHAR(20)) AS Test;

-- failure 3706: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3706] [SQLState 42000] Syntax error: Data Type "NCHAR" does not match a Defined Type name.
-- 0: 24/5 ----------------------------------------------------------------

SELECT CAST('A quick brown fox' AS NATIONAL CHARACTER VARYING(20)) AS Test;

-- failure 3706: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3706] [SQLState 42000] Syntax error: Data Type "NATIONAL" does not match a Defined Type name.
-- 0: 25/5 ----------------------------------------------------------------
SELECT CAST('A quick brown fox' AS NATIONAL CHAR VARYING(20)) AS Test;

-- failure 3706: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3706] [SQLState 42000] Syntax error: Data Type "NATIONAL" does not match a Defined Type name.
-- 0: 26/5 ----------------------------------------------------------------
SELECT CAST('A quick brown fox' AS NCHAR VARYING(20)) AS Test;

-- failure 3706: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3706] [SQLState 42000] Syntax error: Data Type "NCHAR" does not match a Defined Type name.
-- 0: 27/5 ----------------------------------------------------------------

SELECT '你好，世界' AS Test;

-- success. results are:
Test
?????
-- activity count = 1
-- 0: 28/5 ----------------------------------------------------------------

-- Date/Time/Timestamp
SELECT CAST('2001-02-03' AS DATE) AS Test;

-- success. results are:
Test
2001-02-03
-- activity count = 1
-- 0: 29/5 ----------------------------------------------------------------
SELECT CAST('12:03:04' AS TIME) AS Test;

-- success. results are:
Test
12:03:04
-- activity count = 1
-- 0: 30/5 ----------------------------------------------------------------
SELECT CAST('12:03:04.12' AS TIME(2)) AS Test;

-- success. results are:
Test
12:03:04
-- activity count = 1
-- 0: 31/5 ----------------------------------------------------------------
SELECT CAST('12:03:04-08:00' AS TIME WITH TIME ZONE) AS Test;

-- success. results are:
Test
12:03:04
-- activity count = 1
-- 0: 32/5 ----------------------------------------------------------------
SELECT CAST('12:03:04.12-08:00' AS TIME(2) WITH TIME ZONE) AS Test;

-- success. results are:
Test
12:03:04
-- activity count = 1
-- 0: 33/5 ----------------------------------------------------------------
SELECT CAST('2001-02-03 12:03:04' AS TIMESTAMP) AS Test;

-- success. results are:
Test
2001-02-03 12:03:04.0
-- activity count = 1
-- 0: 34/5 ----------------------------------------------------------------
SELECT CAST('2001-02-03 12:03:04.12' AS TIMESTAMP(2)) AS Test;

-- success. results are:
Test
2001-02-03 12:03:04.12
-- activity count = 1
-- 0: 35/5 ----------------------------------------------------------------
SELECT CAST('2001-02-03 12:03:04-08:00' AS TIMESTAMP WITH TIME ZONE) AS Test;

-- success. results are:
Test
2001-02-03 12:03:04.0
-- activity count = 1
-- 0: 36/5 ----------------------------------------------------------------
SELECT CAST('2001-02-03 12:03:04.12-08:00' AS TIMESTAMP(2) WITH TIME ZONE) AS Test;

-- success. results are:
Test
2001-02-03 12:03:04.12
-- activity count = 1
-- 0: 37/5 ----------------------------------------------------------------

--------------------------------------------------------------------------
-- SQL99 types
--------------------------------------------------------------------------

-- Boolean type
SELECT TRUE AS Test;

-- failure 3822: [42S22] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3822] [SQLState 42S22] Cannot resolve column 'TRUE'. Specify table or view.
-- 0: 38/5 ----------------------------------------------------------------
SELECT FALSE AS Test;

-- failure 3822: [42S22] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3822] [SQLState 42S22] Cannot resolve column 'FALSE'. Specify table or view.
-- 0: 39/5 ----------------------------------------------------------------

-- Distinct Types
CREATE TYPE MyInt AS INTEGER FINAL;

-- success. update count = 0
-- 0: 40/5 ----------------------------------------------------------------

SELECT CAST(123 AS MyINT);

-- success. results are:
123
123
-- activity count = 1
-- 0: 41/5 ----------------------------------------------------------------

DROP TYPE MyInt;

-- success. update count = 0
-- 0: 42/5 ----------------------------------------------------------------

--------------------------------------------------------------------------
-- SQL2003 types
--------------------------------------------------------------------------

-- XML
SELECT CAST('<a>123</a>' AS XML);

-- success. results are:
'<a>123</a>'
&lt;a&gt;123&lt;/a&gt;
-- activity count = 1
-- 0: 43/5 ----------------------------------------------------------------
SELECT XMLELEMENT(NAME 'Customer', XMLATTRIBUTES('123' AS id), XMLFOREST('Joe' AS Name));

-- failure 3707: [42000] [Teradata Database] [TeraJDBC 15.10.00.14] [Error 3707] [SQLState 42000] Syntax error, expected something like a name or a Unicode delimited identifier between the 'NAME' keyword and the string 'Customer'.
-- 0: 44/5 ----------------------------------------------------------------

--------------------------------------------------------------------------
-- ST_GEOMETRY
--------------------------------------------------------------------------
SELECT CAST('POINT(1 1)' AS ST_GEOMETRY);

-- success. results are:
'POINT(1 1)'
com.teradata.jdbc.jdk6.JDK6_SQL_Clob@379614be
-- activity count = 1
-- 0: 45/5 ----------------------------------------------------------------
SELECT CAST('POINT(1 1)' AS ST_GEOMETRY).ST_MBR ();

-- success. results are:
'POINT(1 1)'.ST_MBR()
"(1,1,1,1) "
-- activity count = 1
-- 0: 46/5 ----------------------------------------------------------------
